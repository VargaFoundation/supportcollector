<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
<configuration>
  <property>
    <name>collection_enabled</name>
    <value>true</value>
    <description>Active ou désactive la collecte de diagnostics. Si false, aucune collecte n'est effectuée.</description>
    <display-name>Collection Enabled</display-name>
    <value-attributes>
      <type>boolean</type>
    </value-attributes>
  </property>

  <property>
    <name>auto_send_enabled</name>
    <value>true</value>
    <description>Active ou désactive l'envoi automatique des bundles au support. Si false, les bundles sont générés mais pas envoyés.</description>
    <display-name>Auto Send Enabled</display-name>
    <value-attributes>
      <type>boolean</type>
    </value-attributes>
  </property>

  <property>
    <name>send_frequency</name>
    <value>weekly</value>
    <description>Fréquence d'envoi des diagnostics. Valeurs possibles : daily, weekly, monthly.</description>
    <display-name>Send Frequency</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>support_endpoint</name>
    <value>https://support.odp.com/upload</value>
    <description>URL de l'endpoint de support pour l'envoi des bundles diagnostiques.</description>
    <display-name>Support Endpoint URL</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>support_token</name>
    <value></value>
    <description>Token d'authentification pour l'envoi au support. Obligatoire si auto_send_enabled est true.</description>
    <display-name>Support API Token</display-name>
    <property-type>PASSWORD</property-type>
    <value-attributes>
      <type>password</type>
    </value-attributes>
  </property>

  <property>
    <name>hdfs_path</name>
    <value>/odpsc/diagnostics</value>
    <description>Chemin HDFS pour l'archivage optionnel des bundles.</description>
    <display-name>HDFS Archive Path</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>hdfs_archive_enabled</name>
    <value>false</value>
    <description>Active l'archivage optionnel des bundles vers HDFS. Le stockage local reste le stockage primaire.</description>
    <display-name>HDFS Archive Enabled</display-name>
    <value-attributes>
      <type>boolean</type>
    </value-attributes>
  </property>

  <property>
    <name>log_paths</name>
    <value>["/var/log/hadoop/*", "/var/log/hive/*", "/var/log/spark/*", "/var/log/yarn/*"]</value>
    <description>Liste JSON des chemins de logs à collecter (supporte les globs).</description>
    <display-name>Log Paths</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>master_port</name>
    <value>8085</value>
    <description>Port d'écoute du serveur ODPSC Master.</description>
    <display-name>Master Port</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>1024</minimum>
      <maximum>65535</maximum>
    </value-attributes>
  </property>

  <property>
    <name>admin_username</name>
    <value>admin</value>
    <description>Nom d'utilisateur pour l'authentification Basic Auth de l'API de gestion.</description>
    <display-name>Admin Username</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>admin_password</name>
    <value></value>
    <description>Mot de passe pour l'authentification Basic Auth de l'API de gestion. Haché avec bcrypt.</description>
    <display-name>Admin Password</display-name>
    <property-type>PASSWORD</property-type>
    <value-attributes>
      <type>password</type>
    </value-attributes>
  </property>

  <property>
    <name>encryption_key</name>
    <value></value>
    <description>Clé pour le chiffrement AES-256-GCM des bundles. Si vide, une clé est générée automatiquement.</description>
    <display-name>Encryption Key</display-name>
    <property-type>PASSWORD</property-type>
    <value-attributes>
      <type>password</type>
    </value-attributes>
  </property>

  <property>
    <name>log_retention_days</name>
    <value>7</value>
    <description>Nombre de jours de logs à collecter.</description>
    <display-name>Log Retention Days</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>1</minimum>
      <maximum>30</maximum>
    </value-attributes>
  </property>

  <property>
    <name>max_log_size_mb</name>
    <value>1</value>
    <description>Taille maximale en MB de logs à collecter par fichier.</description>
    <display-name>Max Log Size (MB)</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>1</minimum>
      <maximum>100</maximum>
    </value-attributes>
  </property>

  <property>
    <name>ambari_server_url</name>
    <value>http://localhost:8080</value>
    <description>URL du serveur Ambari pour la collecte de métriques et le déclenchement des commandes.</description>
    <display-name>Ambari Server URL</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>cluster_name</name>
    <value>cluster</value>
    <description>Nom du cluster Ambari.</description>
    <display-name>Cluster Name</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>api_key</name>
    <value></value>
    <description>Clé API partagée entre agents et master pour l'authentification des uploads de bundles. Générée automatiquement lors de l'installation.</description>
    <display-name>API Key</display-name>
    <property-type>PASSWORD</property-type>
    <value-attributes>
      <type>password</type>
    </value-attributes>
  </property>

  <property>
    <name>bundle_level</name>
    <value>L1</value>
    <description>Niveau de collecte par défaut. L1: configs+sysinfo, L2: +métriques, L3: +logs.</description>
    <display-name>Bundle Level</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>tls_enabled</name>
    <value>false</value>
    <description>Active le TLS pour le serveur gunicorn du master.</description>
    <display-name>TLS Enabled</display-name>
    <value-attributes>
      <type>boolean</type>
    </value-attributes>
  </property>

  <property>
    <name>tls_cert_path</name>
    <value></value>
    <description>Chemin vers le certificat TLS (PEM) pour le serveur master.</description>
    <display-name>TLS Certificate Path</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>tls_key_path</name>
    <value></value>
    <description>Chemin vers la clé privée TLS pour le serveur master.</description>
    <display-name>TLS Key Path</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>max_upload_size_mb</name>
    <value>100</value>
    <description>Taille maximale en MB pour un upload de bundle agent.</description>
    <display-name>Max Upload Size (MB)</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>1</minimum>
      <maximum>500</maximum>
    </value-attributes>
  </property>

  <property>
    <name>max_bundle_size_mb</name>
    <value>500</value>
    <description>Taille maximale en MB pour un bundle master agrégé.</description>
    <display-name>Max Bundle Size (MB)</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>10</minimum>
      <maximum>2048</maximum>
    </value-attributes>
  </property>

  <property>
    <name>gunicorn_workers</name>
    <value>2</value>
    <description>Nombre de workers gunicorn pour le serveur master.</description>
    <display-name>Gunicorn Workers</display-name>
    <value-attributes>
      <type>int</type>
      <minimum>1</minimum>
      <maximum>16</maximum>
    </value-attributes>
  </property>

  <property>
    <name>cluster_id</name>
    <value></value>
    <description>Identifiant unique du cluster. Généré automatiquement lors de l'installation du master.</description>
    <display-name>Cluster ID</display-name>
    <value-attributes>
      <type>string</type>
    </value-attributes>
  </property>

  <property>
    <name>audit_enabled</name>
    <value>false</value>
    <description>Active l'audit des opérations (bundles reçus, agrégés, envoyés). Désactivé par défaut.</description>
    <display-name>Audit Enabled</display-name>
    <value-attributes>
      <type>boolean</type>
    </value-attributes>
  </property>
</configuration>
